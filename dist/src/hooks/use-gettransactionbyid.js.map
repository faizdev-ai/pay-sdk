{"version":3,"file":"use-gettransactionbyid.js","sourceRoot":"","sources":["../../../src/hooks/use-gettransactionbyid.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,MAAM,EAAE,MAAM,cAAc,CAAC;AAGtC,MAAM,OAAO,qBAAqB;IAOhC,YAAY,IAA4B;QACtC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;QAEzB,kCAAkC;QAClC,IAAI,CAAC,GAAG,GAAG,IAAI,MAAM,CAAsB,IAAI,EAAE,EAAE,EAAE;YACnD,OAAO,EAAE,KAAK;SACf,CAAC,CAAC;IACL,CAAC;IAED;;iCAE6B;IAE7B,IAAI,IAAI;QACN,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC;IACvB,CAAC;IAED,IAAI,OAAO;QACT,2BAA2B;QAC3B,OAAO,IAAI,CAAC,YAAY,CAAC;IAC3B,CAAC;IAED,IAAI,KAAK;QACP,OAAO,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC;IACxB,CAAC;IAED,IAAI,MAAM;QACR,OAAO,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC;IACzB,CAAC;IAED;;iCAE6B;IAE7B,UAAU,CAAC,OAAgB;QACzB,IAAI,CAAC,OAAO,EAAE,CAAC;YACb,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YAC3B,IAAI,CAAC,WAAW,EAAE,CAAC;YACnB,OAAO;QACT,CAAC;QAED,8CAA8C;QAC9C,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,6CAA6C,OAAO,GAAG,CAAC,CAAC;QAEzE,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QAE1B,IAAI,CAAC,YAAY,EAAE,CAAC;IACtB,CAAC;IAED;;iCAE6B;IAErB,YAAY;QAClB,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;QACzB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC,WAAW,CAAC,GAAG,EAAE;YACxC,oCAAoC;YAEpC,IAAI,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,SAAS,IAAI,MAAM,EAAE,CAAC;gBACvC,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;gBAC1B,IAAI,CAAC,WAAW,EAAE,CAAC;gBACnB,OAAO;YACT,CAAC;YAED,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;QACrB,CAAC,EAAE,KAAK,CAAC,CAAC;IACZ,CAAC;IAEO,WAAW;QACjB,IAAI,IAAI,CAAC,UAAU,EAAE,CAAC;YACpB,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAC/B,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;QAC9B,CAAC;IACH,CAAC;IAED,gBAAgB;QACd,IAAI,CAAC,WAAW,EAAE,CAAC;IACrB,CAAC;CACF","sourcesContent":["import { ReactiveController, ReactiveControllerHost } from \"lit\";\nimport { UseApi } from \"./use-api.js\";\n\ntype TransactionResponse = any;\nexport class UseGetTransactionById implements ReactiveController {\n  private host: ReactiveControllerHost;\n  private intervalId?: number;\n  private loadingState?: boolean;\n\n  private api: UseApi<TransactionResponse>;\n\n  constructor(host: ReactiveControllerHost) {\n    this.host = host;\n    host.addController(this);\n\n    // ðŸ”¥ Start disabled and empty URL\n    this.api = new UseApi<TransactionResponse>(host, \"\", {\n      enabled: false,\n    });\n  }\n\n  /* =========================\n     Public Getters\n  ========================== */\n\n  get data() {\n    return this.api.data;\n  }\n\n  get loading() {\n    // return this.api.loading;\n    return this.loadingState;\n  }\n\n  get error() {\n    return this.api.error;\n  }\n\n  get status() {\n    return this.api.status;\n  }\n\n  /* =========================\n     Address Setter\n  ========================== */\n\n  setAddress(address?: string) {\n    if (!address) {\n      this.api.setEnabled(false);\n      this.stopPolling();\n      return;\n    }\n\n    // âœ… Update URL dynamically (THIS was missing)\n    this.api.setUrl(`/transaction/getTransactionByPaymentToken/${address}/`);\n\n    this.api.setEnabled(true);\n\n    this.startPolling();\n  }\n\n  /* =========================\n     Polling\n  ========================== */\n\n  private startPolling() {\n    this.stopPolling();\n    this.loadingState = true;\n    this.intervalId = window.setInterval(() => {\n      // console.log(this.api, \"asdadsa\");\n\n      if (this.api.data?.tx_status == \"paid\") {\n        this.loadingState = false;\n        this.stopPolling();\n        return;\n      }\n\n      this.api.refetch();\n    }, 10000);\n  }\n\n  private stopPolling() {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = undefined;\n    }\n  }\n\n  hostDisconnected() {\n    this.stopPolling();\n  }\n}\n"]}