{"version":3,"file":"use-expire.js","sourceRoot":"","sources":["../../../src/hooks/use-expire.ts"],"names":[],"mappings":"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","sourcesContent":["import { ReactiveController, ReactiveControllerHost } from \"lit\";\n\nexport interface ExpireOptions {\n  expireTime: number | Date;\n  enabled?: boolean;\n  onExpire?: () => void;\n}\n\nexport class UseExpire implements ReactiveController {\n  private host: ReactiveControllerHost;\n  private intervalId?: number;\n  private expireAt: number = 0;\n  private enabled: boolean = false;\n  private onExpire?: () => void;\n\n  days = 0;\n  hours = 0;\n  minutes = 0;\n  seconds = 0;\n  expired = false;\n\n  constructor(host: ReactiveControllerHost, options: ExpireOptions) {\n    this.host = host;\n    host.addController(this);\n    this.setOptions(options);\n  }\n\n  // ğŸ” Update configuration dynamically\n  setOptions(options: ExpireOptions) {\n    this.expireAt =\n      options.expireTime instanceof Date\n        ? options.expireTime.getTime()\n        : options.expireTime;\n\n    this.enabled = !!options.enabled;\n    this.onExpire = options.onExpire;\n\n    if (this.enabled) {\n      this.start();\n    } else {\n      this.stop();\n    }\n  }\n\n  // ğŸš€ Start timer\n  private start() {\n    this.stop();\n    this.expired = false;\n    this.tick();\n\n    this.intervalId = window.setInterval(() => {\n      this.tick();\n    }, 1000);\n  }\n\n  // ğŸ›‘ Stop timer\n  private stop() {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = undefined;\n    }\n  }\n\n  // ğŸ” NEW: Restart timer\n  restart(newExpireTime?: number | Date) {\n    if (newExpireTime) {\n      this.expireAt =\n        newExpireTime instanceof Date ? newExpireTime.getTime() : newExpireTime;\n    }\n\n    this.expired = false;\n\n    if (this.enabled) {\n      this.start();\n    }\n\n    this.host.requestUpdate();\n  }\n\n  // â³ Countdown logic\n  private tick() {\n    const now = Date.now();\n    const diff = this.expireAt - now;\n\n    if (diff <= 0) {\n      this.days = this.hours = this.minutes = this.seconds = 0;\n      this.expired = true;\n      this.stop();\n\n      if (this.onExpire) {\n        this.onExpire();\n      }\n\n      this.host.requestUpdate();\n      return;\n    }\n\n    this.expired = false;\n\n    const totalSeconds = Math.floor(diff / 1000);\n\n    this.days = Math.floor(totalSeconds / (24 * 60 * 60));\n    this.hours = Math.floor((totalSeconds % (24 * 60 * 60)) / (60 * 60));\n    this.minutes = Math.floor((totalSeconds % (60 * 60)) / 60);\n    this.seconds = totalSeconds % 60;\n\n    this.host.requestUpdate();\n  }\n\n  hostDisconnected() {\n    this.stop();\n  }\n}\n"]}