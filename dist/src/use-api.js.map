{"version":3,"file":"use-api.js","sourceRoot":"","sources":["../../src/use-api.ts"],"names":[],"mappings":"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","sourcesContent":["import { ReactiveControllerHost } from \"lit\";\nimport { Task, TaskStatus } from \"@lit/task\";\n\nexport const baseUrl = \"https://paymentgateway-backend.chainbull.net/api\";\n\ninterface UseApiOptions {\n  enabled?: boolean;\n  requestInit?: RequestInit;\n  deps?: unknown[];\n  params?: Record<string, string | number | boolean | undefined>; // ðŸ‘ˆ NEW\n}\n\nexport class UseApi<T> {\n  private host: ReactiveControllerHost;\n  private url: string;\n  private enabled: boolean;\n  private requestInit?: RequestInit;\n  private deps: unknown[];\n  private params?: Record<string, string | number | boolean | undefined>;\n\n  private task: Task<\n    [\n      string,\n      RequestInit | undefined,\n      boolean,\n      Record<string, string | number | boolean | undefined> | undefined,\n      ...unknown[],\n    ],\n    T\n  >;\n\n  constructor(\n    host: ReactiveControllerHost,\n    url: string,\n    options: UseApiOptions = {},\n  ) {\n    this.host = host;\n    this.url = url;\n    this.enabled = options.enabled ?? true;\n    this.requestInit = options.requestInit;\n    this.deps = options.deps ?? [];\n    this.params = options.params;\n\n    this.task = new Task(this.host, {\n      task: async ([url, requestInit, enabled, params], { signal }) => {\n        if (!enabled) {\n          return new Promise<T>(() => {});\n        }\n\n        // âœ… Build query string safely\n        let finalUrl = `${baseUrl}${url}`;\n\n        if (params && Object.keys(params).length > 0) {\n          const searchParams = new URLSearchParams();\n\n          Object.entries(params).forEach(([key, value]) => {\n            if (value !== undefined && value !== null) {\n              searchParams.append(key, String(value));\n            }\n          });\n\n          finalUrl += `?${searchParams.toString()}`;\n        }\n\n        const res = await fetch(finalUrl, {\n          ...requestInit,\n          signal,\n        });\n\n        if (!res.ok) {\n          throw new Error(`HTTP Error: ${res.status}`);\n        }\n\n        return res.json();\n      },\n\n      args: () => [\n        this.url,\n        this.requestInit,\n        this.enabled,\n        this.params,\n        ...this.deps,\n      ],\n    });\n  }\n\n  /* =========================\n     Reactive States\n  ========================== */\n\n  get data(): T | undefined {\n    return this.task.status === TaskStatus.COMPLETE\n      ? this.task.value\n      : undefined;\n  }\n\n  get loading(): boolean {\n    return this.task.status === TaskStatus.PENDING;\n  }\n\n  get error(): unknown {\n    return this.task.status === TaskStatus.ERROR ? this.task.error : undefined;\n  }\n\n  get status(): TaskStatus {\n    return this.task.status;\n  }\n\n  get isInitial() {\n    return this.task.status === TaskStatus.INITIAL;\n  }\n\n  get isSuccess() {\n    return this.task.status === TaskStatus.COMPLETE;\n  }\n\n  get isError() {\n    return this.task.status === TaskStatus.ERROR;\n  }\n\n  /* =========================\n     Controls\n  ========================== */\n\n  refetch() {\n    this.task.run();\n  }\n\n  setEnabled(value: boolean) {\n    if (this.enabled !== value) {\n      this.enabled = value;\n      this.host.requestUpdate();\n    }\n  }\n\n  setUrl(newUrl: string) {\n    if (this.url !== newUrl) {\n      this.url = newUrl;\n      this.host.requestUpdate();\n    }\n  }\n\n  setRequestInit(requestInit?: RequestInit) {\n    this.requestInit = requestInit;\n    this.host.requestUpdate();\n  }\n\n  setDependencies(deps: unknown[]) {\n    this.deps = deps;\n    this.host.requestUpdate();\n  }\n\n  setParams(params?: Record<string, string | number | boolean | undefined>) {\n    this.params = params;\n    this.host.requestUpdate();\n  }\n}\n"]}